{% load staticfiles %}
<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="{% static 'css/chatroom_style.css' %}">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<title>BBMAN</title>
	</head>
	<body style="margin-top:150px;">
        <div class="row" id="messages">
            <div class="col-md-4 col-md-offset-4">
                <div id="response">
                    <div id="frame1"><div id="m1" class="well-sm">This</div></div>
                    <div id="frame2"><div id="m2" class="well-sm">This</div></div>
                    <div id="frame3"><div id="m3" class="well-sm">This</div></div>
                    <div id="frame4"><div id="m4" class="well-sm">This</div></div>
                    <div id="frame5"><div id="m5" class="well-sm">This</div></div>
                </div>
                <div class="input-group">
                    <span class="input-group-btn">
                        <button style="height: 45px;" id="fontChanger" class="btn btn-default" type="button">T</button>
                    </span>
                    <input style="height: 45px;" class="form-control" id="inputBox" type="text" placeholder="Please enter your message.">
                    <span class="input-group-btn">
                        <button id="sendButton" class="btn btn-default" type="button"><img style="height: 30px; width:30px" src="{% static 'img/send.png' %}"></button>
                    </span>
                </div>
            </div>
			<div id="getMessages">
                <button id="likeButton">Like</button>
                <button id="reportButton">Report</button>
            </div>
        </div>
 	</body>

    <script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
    <script src="{% static 'scripts/main.js' %}"></script>
    <script>
        $(function(){
            get_messages("{{ chatroom.id }}");
            var send = document.getElementById("sendButton");
            var inputBox = document.getElementById("inputBox");
            send.addEventListener("click", function(e){
                e.preventDefault();

                send_message({{user.id}}, {{chatroom.id}}, inputBox.value);
                inputBox.value = "";
            });

            inputBox.addEventListener("keydown", function(e) {
              if (e.keyCode == 13) {
                e.preventDefault(); // sometimes useful
                send_message({{user.id}}, {{chatroom.id}}, inputBox.value);
                inputBox.value="";
              }
    }, false);
        });
        window.onbeforeunload = function (event) {
            var message = "Ri!";
            $.post('/chatroom/leave/', {"uid": {{user.id}} ,"cid": {{chatroom.id}} });
            return message;

        }
</script>
